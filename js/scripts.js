let xmlhttp = new XMLHttpRequest();
let nbPage = 0;
let pageSize = 5;
let startIndex = 0;
let endIndex = 0;
let page = 1;

function loadXMLDoc() {
    xmlhttp.onreadystatechange = function () {
        if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
            fetchData();
            showPageLinks();
        }
    };
    xmlhttp.open("GET", "https://obiwan.univ-brest.fr/~e22209009/data/bdd.xml", true);
    xmlhttp.send();
}
function fetchData() {
    let i;
    let xmlDoc = xmlhttp.responseXML;
    let table = "<tr><th>Questions</th><th>response 1</th><th>response 2</th><th>response 3</th></tr>";
    let x = xmlDoc.getElementsByTagName("question");
       nbPage=Math.ceil(x.length/pageSize);
     

    //Calculer startIndex et endIndex    
    startIndex=(page-1)*pageSize;
    endIndex=Math.min(startIndex + pageSize-1,x.length);

    for (i = startIndex; i < endIndex; i++) {
        table += "<tr><td>" +
        x[i].getElementsByTagName("contenu")[0].textContent +
        "</td><td>" +
        x[i].getElementsByTagName("response1")[0].textContent +
        "</td><td>" +
        x[i].getElementsByTagName("response2")[0].textContent +
        "</td><td>" +
        x[i].getElementsByTagName("response3")[0].textContent +
        "</td>" +
        "</tr>";

    }
    document.getElementById("data").innerHTML = table;
}

 function loadPage(pageNumber) {
    //Mettre à jour la valeur de page en fonction de pageNumber
    page = pageNumber;
    //Appeler la fonction fetchData 
    fetchData();
    showPageLinks();
}   

function showPageLinks() {
    let divpl = document.getElementById("pageLinks");
    divpl.style.display = "block";
    let pageLinks="";
    let i;
    for (i = 1; i <= nbPage; i++) {
        pageLinks += "<input type='button' onclick='loadPage(" + i
        +")' value='"+i+"'></input>";
        }
        divpl.innerHTML = pageLinks;

    }



function filtrerData() {
    let i;
    let xmlDoc = xmlhttp.responseXML;
    let table = "<tr><th>Questions</th><th>response 1</th><th>response 2</th><th>response 3</th><th>Thématique</th></tr>";
    let x = xmlDoc.getElementsByTagName("question");
    let slCategory=document.getElementById("thematique");
    let choix = slCategory.options[slCategory.selectedIndex].value;
    for (i = 0; i < x.length; i++) {
        if(x[i].getElementsByTagName("thematique")[0].textContent== choix || choix=="Tout" ){
            table += "<tr><td>" +
            x[i].getElementsByTagName("contenu")[0].textContent +
            "</td><td>" +
            x[i].getElementsByTagName("response1")[0].textContent +
            "</td><td>" +
            x[i].getElementsByTagName("response2")[0].textContent +
            "</td><td>" +
            x[i].getElementsByTagName("response3")[0].textContent +
            "</td><td>" +
            x[i].getElementsByTagName("thematique")[0].textContent +
            "</td>" +
            "</tr>";
        } 
    }

    document.getElementById("data").innerHTML = table;
}     




































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































